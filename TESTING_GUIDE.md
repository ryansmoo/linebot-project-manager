# 🧪 Google Calendar 功能測試指南

## ✅ 已完成設定

### 1. Google OAuth 憑證已設定
- 用戶端 ID: `236431413848-nsnitui7t561pigjitsddjb55q776pji.apps.googleusercontent.com`
- 重新導向 URI: `http://localhost:3000/auth/google/callback`
- .env 檔案已更新 ✅

### 2. 服務狀態
- ✅ Google Calendar API 初始化成功
- ✅ 資料庫初始化完成  
- ✅ Bot 在 port 3000 運行中
- ✅ 時間識別功能測試通過

## 🎯 現在可以開始測試！

### 第一步：測試時間識別
在您的 LINE Bot 聊天室中輸入以下任何一個：
```
20:00 回家吃飯
18:30 開會討論
9:15 去買菜
14：30 午休時間（支援中文冒號）
```

**預期結果：**
- 會收到 Flex Message 卡片
- 卡片會顯示「📅 上傳日曆」按鈕
- 顯示解析出的時間（例如：⏰ 時間：20:00）

### 第二步：測試 Google 授權
1. 點擊「📅 上傳日曆」按鈕
2. 會收到授權提示卡片
3. 點擊「🔗 前往授權」按鈕
4. 在瀏覽器中完成 Google 授權
5. 看到「✅ Google Calendar 授權成功！」頁面

### 第三步：測試日曆同步
1. 授權完成後，回到 LINE 聊天室
2. 重新輸入帶時間的任務：`19:00 和朋友聚餐`
3. 點擊「📅 上傳日曆」按鈕
4. 應該會收到「✅ 成功加入日曆！」確認訊息
5. 點擊「📅 查看日曆」確認事件已建立

## 🔍 測試不同情況

### 有效的時間格式（會顯示日曆按鈕）：
- `8:00 早餐`
- `09:30 晨會`
- `14:00 下午茶`
- `23:59 睡前檢查`
- `18：30 用餐`（中文冒號）

### 無效格式（不會顯示日曆按鈕）：
- `沒有時間的任務`
- `25:99 無效時間`
- `今天要買牛奶`

## 🛠️ 故障排除

### 如果授權失敗：
1. 檢查 Google Cloud Console 中的 OAuth 設定
2. 確認重新導向 URI 是否正確
3. 查看控制台錯誤訊息

### 如果無法創建事件：
1. 確認已完成 Google 授權
2. 檢查 Google Calendar API 是否啟用
3. 查看伺服器日誌：`tail -f bot.log`

## 📊 API 測試端點

### 檢查服務狀態：
```bash
curl http://localhost:3000/health
```

### 檢查用戶授權狀態：
```bash
curl http://localhost:3000/api/calendar/status/your-line-user-id
```

### 撤銷用戶授權：
```bash
curl -X POST http://localhost:3000/api/calendar/revoke/your-line-user-id
```

## 🎉 成功標誌

看到以下訊息代表功能正常：

1. **時間識別成功**：
   ```
   📝 任務已記錄
   您的任務：20:00 回家吃飯
   ⏰ 時間：20:00
   [📝 編輯] [📅 上傳日曆]
   ✅ 任務已記錄，可同步到 Google 日曆
   ```

2. **授權成功**：
   ```
   ✅ Google Calendar 授權成功！
   ```

3. **同步成功**：
   ```
   ✅ 成功加入日曆！
   您的任務已成功同步到 Google Calendar
   ```

## 📝 注意事項

- 每個用戶需要獨立完成一次授權
- 授權資訊會儲存在記憶體中（重啟服務需重新授權）  
- 支援的時間格式：`HH:MM`、`H:MM`、`HH：MM`
- 自動設定 10 分鐘前彈窗提醒和 1 小時前郵件提醒

---

**🚀 準備好了嗎？現在就去您的 LINE Bot 試試吧！**